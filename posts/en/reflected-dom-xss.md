---
id: "reflected-dom-xss"
title: "Reflected DOM XSS â€“ PortSwigger Write Up"
author: "juan-antonio-gonzalez-mena"
publishedDate: 2022-05-03
updatedDate: 2022-05-03
image: "https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-0.webp"
description: "Learn how to exploit a Reflected DOM XSS vulnerability in PortSwigger Lab. Step-by-step guide to identify and exploit an insecure script that processes reflected data in the DOM in a vulnerable way."
categories:
  - "portswigger-labs"
draft: false
featured: false
lang: "en"
---

In this post, we're going to be solving the lab: "Reflected DOM XSS":

![Reflected DOM XSS lab start screen](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-1.avif)

In this case, we're told that the server processes request data and displays the response data. Subsequently, a page script processes the reflected data in an insecure way. To solve the lab, we must execute the `alert` function.

That said, the first thing to do is access the lab:

![Lab main page with search form](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-2.avif)

Once accessed, we can observe a form that allows us to search the blog. To better analyze the behavior of this functionality, we open Burp Suite and activate the proxy in the browser:

![Proxy configuration in the browser](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-3.avif)

![Burp Suite interceptor activated and waiting](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-4.avif)

With this done, we try to perform any search:

![Search form with test term](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-5.avif)

![Intercepted GET request with search parameter](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-6.avif)

When we click `Search`, the request shown above is generated. There isn't much information, and since the statement spoils that the vulnerability is in an insecure script, we can assume that the first search request doesn't have much to it, so we simply send it.

When we send the first search request, if we keep Burp Suite's intercept on, we'll intercept the following request:

![Second intercepted JSON request generated by the frontend](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-7.avif)

This looks like it was generated by the frontend of the resource requested in the first request (`/?search=test`). To better analyze its response, we send it to the repeater:

![JSON response in Burp Suite Repeater showing search term](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-8.avif)

The server returns a response in JSON format, where at the bottom we can observe the search term we entered.

We can try to escape from the JSON context in this case, for example, try to inject an `alert`:

![Test payload injected in the search parameter](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-9.avif)

In the response, we can observe that apparently we can inject and escape from the JSON without problems, since there's no sanitization whatsoever, so using the payload above, we place it in the request we left in the proxy and send it:

![Request with XSS payload sent from the proxy](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-10.avif)

![Successful alert execution showing XSS](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-11.avif)

This way, we successfully obtain an XSS and solve the lab:

![Lab solved successfully message](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-12.avif)

![Final confirmation of lab success](https://cdn.deephacking.tech/i/posts/portswigger-labs/reflected-dom-xss/reflected-dom-xss-13.avif)
